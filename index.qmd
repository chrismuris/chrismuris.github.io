---
format:
  html:
    page-layout: article
    toc: false
    include-in-header:
      text: |
        <link rel="shortcut icon" href="profile_pic.jpg">
        <meta property="og:description" content="Associate Professor of Economics at McMaster University specializing in theoretical econometrics and panel data.">
        <meta property="og:image" content="profile_pic.jpg">
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:image" content="profile_pic.jpg">
        <style>
          .profile-pic-main {
              width: 280px !important;
              height: 280px !important;
          }
          /* Force buttons to contain text and have consistent sizing */
          .pub-btn {
              white-space: nowrap !important;
              width: auto !important;
              min-width: max-content !important;
              padding: 4px 14px !important;
              font-size: 0.8rem !important;
              display: inline-flex !important;
              align-items: center;
              justify-content: center;
              text-decoration: none !important;
              border-radius: 4px !important;
          }
        </style>
---

:::{.profile-header}
:::{.profile-pic-container}
<img src="profile_pic.jpg" class="profile-pic-main">
:::

:::{.profile-info}
:::{.profile-links-grid}
<a href="./CV/CV_ChrisMuris.pdf" class="btn btn-primary" target="_blank">
  <i class="bi bi-file-earmark-person me-2"></i> CV
</a>
<a href="mailto:muerisc@mcmaster.ca" class="btn btn-outline-primary"><i class="bi bi-envelope"></i> Email</a>
<a href="https://scholar.google.com/citations?user=zh8YkR8AAAAJ&hl=en" class="btn btn-outline-primary" target="_blank"><i class="bi bi-mortarboard"></i> Scholar</a>
<a href="https://github.com/chrismuris" class="btn btn-outline-primary" target="_blank"><i class="bi bi-github"></i> Github</a>
<a href="https://arxiv.org/a/0000-0003-2781-3514.html" class="btn btn-outline-primary" target="_blank"><i class="bi bi-journal-text"></i> Arxiv</a>
<a href="https://www.linkedin.com/in/chris-muris-4b5b03382" class="btn btn-outline-primary" target="_blank"><i class="bi bi-linkedin"></i> LinkedIn</a>
<a href="https://orcid.org/0000-0003-2781-3514" class="btn btn-outline-primary" target="_blank"><i class="bi bi-person-badge"></i> ORCID</a>
:::
:::
:::

<div class="lead">
I am an associate professor in the Department of Economics at McMaster University. 
My research is in the area of theoretical econometrics.
I develop and study new tools for the analysis of panel (longitudinal) data.
</div>

```{{{{#|
#| echo: false
#| warning: false
#| message: false

library(yaml)
library(reactable)
library(htmltools)
library(dplyr)
library(purrr)

# Javascript for Clipboard Copy
htmltools::tagList(
  tags$script(HTML("\n    function copyToClipboard(text) {\n      if (navigator.clipboard && window.isSecureContext) {\n        navigator.clipboard.writeText(text).then(function() {\n          alert('BibTeX copied to clipboard!');\n        }, function(err) {\n          console.error('Async: Could not copy text: ', err);\n        });\n      } else {\n        // Fallback for non-secure contexts (if any)\n        let textArea = document.createElement('textarea');\n        textArea.value = text;\n        document.body.appendChild(textArea);\n        textArea.focus();\n        textArea.select();\n        try {\n          document.execCommand('copy');\n          alert('BibTeX copied to clipboard!');\n        } catch (err) {\n          console.error('Fallback: Unable to copy', err);\n        }\n        document.body.removeChild(textArea);\n      }\n    }\n  "))
)

# Helper to render consistent buttons
make_btn <- function(label, href, icon, class_type, onclick = NULL) {
  tags$a(
    href = href,
    class = paste("btn pub-btn", class_type),
    target = "_blank",
    onclick = onclick,
    tags$i(class = paste("bi", icon, "me-1")),
    label
  )
}

# Load data
pubs <- yaml::read_yaml("publications.yml")

# Convert to data frame
df <- pubs |>
  map_dfr(function(x) {
    code_val <- if (is.null(x$code)) list() else if (is.character(x$code)) list(list(name = "Code", url = x$code)) else x$code
    
    # BibTeX
    first_author_last <- strsplit(strsplit(x$author, ",")[[1]][1], " ")[[1]]
    first_author_last <- first_author_last[length(first_author_last)]
    bib_id <- paste0(first_author_last, x$year)
    bib_type <- if(x$type == "journal_article") "article" else "workingpaper"
    bib_str <- paste0(
      "@", bib_type, "{", bib_id, ",\n",
      "  title = {", x$title, "},\n",
      "  author = {", gsub(",", " and", x$author), "},\n",
      "  year = {", x$year, "},\n",
      if (!is.null(x$journal)) paste0("  journal = {", x$journal, "},\n") else "",
      if (!is.null(x$volume)) paste0("  volume = {", x$volume, "},\n") else "",
      if (!is.null(x$issue)) paste0("  number = {", x$issue, "},\n") else "",
      if (!is.null(x$pages)) paste0("  pages = {", x$pages, "},\n") else "",
      if (!is.null(x$doi)) paste0("  doi = {", x$doi, "},\n") else "",
      if (!is.null(x$url)) paste0("  url = {", x$url, "}\n") else "",
      "}"
    )

    tibble(
      year = as.character(x$year),
      title = x$title,
      author = x$author,
      journal = ifelse(is.null(x$journal), "", x$journal),
      type = ifelse(is.null(x$type), "journal_article", x$type),
      abstract = ifelse(is.null(x$abstract), "", x$abstract),
      doi = ifelse(is.null(x$doi), NA, x$doi),
      url = ifelse(is.null(x$url), NA, x$url),
      code = list(code_val),
      slides = ifelse(is.null(x$slides), NA, x$slides),
      bibtex = bib_str,
      volume = ifelse(is.null(x$volume), NA, x$volume),
      issue = ifelse(is.null(x$issue), NA, x$issue),
      pages = ifelse(is.null(x$pages), NA, x$pages)
    )
  }) |>
  arrange(desc(year))

# Helper function to render table
render_pubs_table <- function(data, searchable = TRUE, show_buttons_inline = TRUE, show_buttons_in_details = FALSE) {
  reactable(
    data,
    searchable = searchable,
    columns = list(
      year = colDef(show = FALSE, searchable = TRUE),
      author = colDef(show = FALSE, searchable = TRUE),
      journal = colDef(show = FALSE, searchable = TRUE),
      type = colDef(show = FALSE),
      abstract = colDef(show = FALSE, searchable = TRUE),
      doi = colDef(show = FALSE),
      url = colDef(show = FALSE),
      code = colDef(show = FALSE),
      slides = colDef(show = FALSE),
      bibtex = colDef(show = FALSE),
      volume = colDef(show = FALSE),
      issue = colDef(show = FALSE),
      pages = colDef(show = FALSE),

      title = colDef(
        name = "",
        cell = function(value, index) {
          row <- data[index, ]
          auths <- trimws(unlist(strsplit(row$author, ",")))
          last_names <- sapply(auths, function(x) { parts <- unlist(strsplit(x, " ")); parts[length(parts)] })
          auths <- auths[order(last_names)]
          auth_str <- if (length(auths) > 1) paste0(paste(auths[-length(auths)], collapse = ", "), " and ", auths[length(auths)]) else auths
          
          doi_val <- row$doi
          url_val <- row$url
          final_url <- if (!is.na(doi_val) && doi_val != "") paste0("https://doi.org/", doi_val) else url_val
          
          title_el <- if (!is.na(final_url)) {
            tags$a(href = final_url, target = "_blank", style = "text-decoration: none; color: #1a5276; font-weight: 500;", onclick = "event.stopPropagation();", row$title)
          } else {
            tags$span(style = "font-weight: 500;", row$title)
          }
          
          venue_part <- NULL
          if (!is.na(row$journal) && row$journal != "") {
             is_forthcoming <- (is.na(row$volume) || row$volume == "") && (is.na(row$pages) || row$pages == "")
             if (is_forthcoming) {
                venue_part <- tags$span(tags$i(row$journal), ", forthcoming")
             } else {
                venue_part <- tags$span(tags$i(row$journal), if(!is.na(row$volume)) paste0(", ", row$volume) else "", if(!is.na(row$issue)) paste0("(", row$issue, ")") else "", if(!is.na(row$pages)) paste0(": ", row$pages) else "")
             }
          }

          suffix <- if (!is.null(venue_part)) "," else "."
          
          btns_div_inline <- NULL
          if (show_buttons_inline) {
            doi_link <- if (!is.na(row$doi) && row$doi != "") paste0("https://doi.org/", row$doi) else NA
            url_link <- if (!is.na(row$url) && row$url != "") row$url else NA

            p_btn <- if (!is.na(doi_link)) make_btn("Paper", doi_link, "bi-file-earmark-text", "btn-outline-primary", "event.stopPropagation();") else if (!is.na(url_link)) make_btn("Paper", url_link, "bi-file-earmark-text", "btn-outline-primary", "event.stopPropagation();") else NULL
            pre_btn <- if (!is.na(doi_link) && !is.na(url_link) && url_link != doi_link) make_btn("Preprint", url_link, "bi-file-earmark-pdf", "btn-outline-secondary", "event.stopPropagation();") else NULL
            c_btns <- if (length(row$code[[1]]) > 0) lapply(row$code[[1]], function(c) make_btn(c$name, c$url, "bi-github", "btn-outline-dark", "event.stopPropagation();")) else NULL
            s_btn <- if (!is.na(row$slides)) make_btn("Slides", row$slides, "bi-easel", "btn-outline-secondary", "event.stopPropagation();") else NULL
            ci_btn <- tags$button(class = "btn pub-btn btn-outline-info", onclick = paste0("event.stopPropagation(); copyToClipboard(`", row$bibtex, "`)"), tags$i(class = "bi bi-quote me-1"), "Cite")

            btns_div_inline <- tags$span(class = "d-inline-flex gap-2 ms-2 flex-wrap", style = "vertical-align: middle; width: auto;", p_btn, pre_btn, c_btns, s_btn, ci_btn)
          }
          
          tags$div(
            class = "pub-citation-container",
            style = "font-family: 'Roboto', sans-serif; line-height: 1.6; color: #333; padding-left: 20px; text-indent: -20px; margin-bottom: 12px; display: block;",
            tags$span(class = "me-2", style = "text-indent: 0px; display: inline-block; width: 15px; color: #999;", tags$i(class = "bi bi-chevron-right small")),
            tags$span(class = "pub-citation", tags$span(style = "font-weight: 500;", auth_str), tags$span(paste0(" (", row$year, "): ")), tags$span("“", title_el, suffix, "”"), if (!is.null(venue_part)) tags$span(" ", venue_part, tags$span(". "))),
            btns_div_inline
          )
        }
      )
    ),
    details = function(index) {
      row <- data[index, ]
      details_btns <- NULL
      if (show_buttons_in_details) {
          doi_link <- if (!is.na(row$doi) && row$doi != "") paste0("https://doi.org/", row$doi) else NA
          url_link <- if (!is.na(row$url) && row$url != "") row$url else NA
          p_btn <- if (!is.na(doi_link)) make_btn("Paper", doi_link, "bi-file-earmark-text", "btn-outline-primary") else if (!is.na(url_link)) make_btn("Paper", url_link, "bi-file-earmark-text", "btn-outline-primary") else NULL
          pre_btn <- if (!is.na(doi_link) && !is.na(url_link) && url_link != doi_link) make_btn("Preprint", url_link, "bi-file-earmark-pdf", "btn-outline-secondary") else NULL
          c_btns <- if (length(row$code[[1]]) > 0) lapply(row$code[[1]], function(c) make_btn(c$name, c$url, "bi-github", "btn-outline-dark")) else NULL
          s_btn <- if (!is.na(row$slides)) make_btn("Slides", row$slides, "bi-easel", "btn-outline-secondary") else NULL
          ci_btn <- tags$button(class = "btn pub-btn btn-outline-info", onclick = paste0("copyToClipboard(`", row$bibtex, "`)"), tags$i(class = "bi bi-quote me-1"), "Cite")
          details_btns <- tags$div(class = "d-flex gap-2 mb-3 flex-wrap", p_btn, pre_btn, c_btns, s_btn, ci_btn)
      }
      if (nchar(row$abstract) > 0 || !is.null(details_btns)) {
        tags$div(class = "p-4 bg-light border-top", details_btns, if (nchar(row$abstract) > 0) tags$p(class = "abstract-text text-muted mb-0", style = "font-family: 'Roboto', sans-serif; font-size: 0.95rem; text-align: left; max-width: 800px; line-height: 1.6;", row$abstract) else NULL)
      } else NULL
    },
    pagination = FALSE, highlight = TRUE, striped = FALSE, outlined = FALSE, borderless = TRUE, width = "100%",
    theme = reactableTheme(cellPadding = "12px 0px", searchInputStyle = list(width = "100%", marginBottom = "10px"), headerStyle = list(display = "none")),
    onClick = "expand", class = "custom-reactable"
  )
}

pubs_df <- df |> filter(type == "journal_article")
wp_df <- df |> filter(type != "journal_article")
```

## Working Papers

````{{{{#|
#| echo: false
render_pubs_table(wp_df, searchable = FALSE, show_buttons_inline = FALSE, show_buttons_in_details = TRUE)
````

## Publications

````{{{{#|
#| echo: false
render_pubs_table(pubs_df)
````